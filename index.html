<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="N2O : WebSocket Application Server">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>N2O</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/synrc/n2o">View on GitHub</a>

          <h1 id="project_title">N2O</h1>
          <h2 id="project_tagline">WebSocket Application Server</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/synrc/n2o/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/synrc/n2o/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="n2o-erlang-application-server" class="anchor" href="#n2o-erlang-application-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>N2O: Erlang Application Server</h1>

<p><a href="https://travis-ci.org/synrc/n2o"><img src="https://travis-ci.org/synrc/n2o.svg?branch=master" alt="Build Status"></a></p>

<h2>
<a id="features" class="anchor" href="#features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Formatters: <strong>BERT</strong>, JSON — changeable on the fly</li>
<li>Protocols: <a href="http://5ht.co/n2o.htm">N2O</a>, <a href="http://5ht.co/n2o.htm">NITRO</a>, <a href="http://5ht.co/n2o.htm">SPA</a>, <a href="http://5ht.co/ftp.htm">FTP</a>
</li>
<li>Endpoints: <strong>WebSocket</strong>, HTTP, <a href="http://synrc.github.io/rest">REST</a>
</li>
<li>High Performance Protocol Relay</li>
<li>Smallest possible codebase — <strong>1K</strong> <strong>LOC</strong>
</li>
<li>BEAM/LING support on posix, arm, mips and xen platforms</li>
<li>Single-file atomic packaging with <a href="http://synrc.github.io/mad">MAD</a>
</li>
<li>Handlers

<ul>
<li>PubSub: MQS, GPROC</li>
<li>Templates: DTL, <a href="http://synrc.github.io/nitro">NITRO</a>
</li>
<li>Sessions: server driven</li>
<li>DOM Language: SHEN JavaScript Compiler</li>
<li>Error Logging: IO, LOGGER</li>
<li>Security: PLAIN, AES CBC 128</li>
</ul>
</li>
<li>Speed: <strong>30K</strong> <strong>conn/s</strong> at notebook easily</li>
<li>Samples: Skyline (DSL), Games (SPA), Review (KVS), Sample (MAD)</li>
</ul>

<h2>
<a id="optional-dependencies" class="anchor" href="#optional-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optional Dependencies</h2>

<p>N2O comes with BERT message formatter support out of the box, and you only need
one N2O dependency in this case. Should you need DTL templates, JSON message formatter, 
SHEN JavaScript Compiler or NITRO Nitrogen DSL you can plug all of them in separately:</p>

<div class="highlight highlight-source-erlang"><pre>{<span class="pl-c1">n2o</span>,    <span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,{<span class="pl-c1">git</span>,<span class="pl-s"><span class="pl-pds">"</span>git://github.com/synrc/n2o<span class="pl-pds">"</span></span>,         {<span class="pl-c1">tag</span>, <span class="pl-s"><span class="pl-pds">"</span>2.8<span class="pl-pds">"</span></span>}}},
{<span class="pl-c1">nitro</span>,  <span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,{<span class="pl-c1">git</span>,<span class="pl-s"><span class="pl-pds">"</span>git://github.com/synrc/nitro<span class="pl-pds">"</span></span>,       {<span class="pl-c1">tag</span>, <span class="pl-s"><span class="pl-pds">"</span>2.8<span class="pl-pds">"</span></span>}}},
{<span class="pl-c1">shen</span>,   <span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,{<span class="pl-c1">git</span>,<span class="pl-s"><span class="pl-pds">"</span>git://github.com/synrc/shen<span class="pl-pds">"</span></span>,        {<span class="pl-c1">tag</span>, <span class="pl-s"><span class="pl-pds">"</span>1.5<span class="pl-pds">"</span></span>}}},
{<span class="pl-c1">jsone</span>,  <span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,{<span class="pl-c1">git</span>,<span class="pl-s"><span class="pl-pds">"</span>git://github.com/sile/jsone.git<span class="pl-pds">"</span></span>,    {<span class="pl-c1">tag</span>,<span class="pl-s"><span class="pl-pds">"</span>v0.3.3<span class="pl-pds">"</span></span>}}},
{<span class="pl-c1">erlydtl</span>,<span class="pl-s"><span class="pl-pds">"</span>.*<span class="pl-pds">"</span></span>,{<span class="pl-c1">git</span>,<span class="pl-s"><span class="pl-pds">"</span>git://github.com/evanmiller/erlydtl<span class="pl-pds">"</span></span>,{<span class="pl-c1">tag</span>,<span class="pl-s"><span class="pl-pds">"</span>0.8.0<span class="pl-pds">"</span></span>}}},</pre></div>

<h2>
<a id="message-formatters" class="anchor" href="#message-formatters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Message Formatters</h2>

<p>You can use any message formmatter at the bottom of N2O protocol.
IO messages supported by the N2O protocol are as follows:</p>

<pre><code>1. BERT : {io,"console.log('hello')",1}
2. WAMP : [io,"console.log('hello')",1]
3. JSON : {name:io,eval:"console.log('hello')",data:1}
4. TEXT : IO console.log('hello') 1\n
5. XML  : &lt;io&gt;&lt;eval&gt;console.log('hello')&lt;/eval&gt;&lt;data&gt;1&lt;/data&gt;&lt;/io&gt;
</code></pre>

<p>Besides, you can even switch a channel termination formatter on the fly
within one WebSocket session.</p>

<h2>
<a id="all-features-in-one-snippet" class="anchor" href="#all-features-in-one-snippet" aria-hidden="true"><span class="octicon octicon-link"></span></a>All Features in One snippet</h2>

<div class="highlight highlight-source-erlang"><pre>-<span class="pl-k">module</span>(<span class="pl-en">index</span>).
-<span class="pl-k">compile</span>(<span class="pl-c1">export_all</span>).
-<span class="pl-k">include_lib</span>(<span class="pl-s"><span class="pl-pds">"</span>nitro/include/nitro.hrl<span class="pl-pds">"</span></span>).
-<span class="pl-k">include_lib</span>(<span class="pl-s"><span class="pl-pds">"</span>n2o/include/wf.hrl<span class="pl-pds">"</span></span>).

<span class="pl-en">peer</span>()    <span class="pl-k">-&gt;</span> <span class="pl-en">io_lib</span>:<span class="pl-en">format</span>(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-c1">~p</span><span class="pl-pds">"</span></span>,[<span class="pl-en">wf</span>:<span class="pl-en">peer</span>(<span class="pl-k">?</span><span class="pl-en">REQ</span>)]).
<span class="pl-en">message</span>() <span class="pl-k">-&gt;</span> <span class="pl-en">wf</span>:<span class="pl-en">js_escape</span>(<span class="pl-en">wf</span>:<span class="pl-en">html_encode</span>(<span class="pl-en">wf</span>:<span class="pl-en">q</span>(<span class="pl-c1">message</span>))).
<span class="pl-en">main</span>()    <span class="pl-k">-&gt;</span> <span class="pl-k">#</span><span class="pl-en">dtl</span>{<span class="pl-smi">file</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>index<span class="pl-pds">"</span></span>,<span class="pl-smi">app</span><span class="pl-k">=</span><span class="pl-c1">n2o_sample</span>,<span class="pl-smi">bindings</span><span class="pl-k">=</span>[{<span class="pl-c1">body</span>,<span class="pl-en">body</span>()}]}.
<span class="pl-en">body</span>() <span class="pl-k">-&gt;</span>
    {<span class="pl-smi">Pid</span>,<span class="pl-v">_</span>} <span class="pl-k">=</span> <span class="pl-en">wf</span>:<span class="pl-en">async</span>(<span class="pl-k">fun</span>(<span class="pl-smi">X</span>) -&gt; <span class="pl-en">chat_loop</span>(<span class="pl-smi">X</span>) <span class="pl-k">end</span>),
    [ <span class="pl-k">#</span><span class="pl-en">panel</span>{<span class="pl-smi">id</span><span class="pl-k">=</span><span class="pl-c1">history</span>}, <span class="pl-k">#</span><span class="pl-en">textbox</span>{<span class="pl-smi">id</span><span class="pl-k">=</span><span class="pl-c1">message</span>},
      <span class="pl-k">#</span><span class="pl-en">button</span>{<span class="pl-smi">id</span><span class="pl-k">=</span><span class="pl-c1">send</span>,<span class="pl-smi">body</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Chat<span class="pl-pds">"</span></span>,<span class="pl-smi">postback</span><span class="pl-k">=</span>{<span class="pl-c1">chat</span>,<span class="pl-smi">Pid</span>},<span class="pl-smi">source</span><span class="pl-k">=</span>[<span class="pl-c1">message</span>]} ].

<span class="pl-en">event</span>(<span class="pl-c1">init</span>) <span class="pl-k">-&gt;</span> <span class="pl-en">wf</span>:<span class="pl-en">reg</span>(<span class="pl-c1">room</span>);
<span class="pl-en">event</span>({<span class="pl-c1">chat</span>,<span class="pl-smi">Pid</span>}) <span class="pl-k">-&gt;</span> <span class="pl-smi">Pid</span> <span class="pl-k">!</span> {<span class="pl-en">peer</span>(), <span class="pl-en">message</span>()};
<span class="pl-en">event</span>(<span class="pl-smi">Event</span>) <span class="pl-k">-&gt;</span> <span class="pl-c1">skip</span>.

<span class="pl-en">chat_loop</span>({<span class="pl-smi">Peer</span>, <span class="pl-smi">Message</span>} ) <span class="pl-k">-&gt;</span>
       <span class="pl-en">wf</span>:<span class="pl-en">insert_bottom</span>(<span class="pl-c1">history</span>,<span class="pl-k">#</span><span class="pl-en">panel</span>{<span class="pl-smi">body</span><span class="pl-k">=</span>[<span class="pl-smi">Peer</span>,<span class="pl-s"><span class="pl-pds">"</span>: <span class="pl-pds">"</span></span>,<span class="pl-smi">Message</span>,<span class="pl-k">#</span><span class="pl-en">br</span>{}]}),
       <span class="pl-en">wf</span>:<span class="pl-en">flush</span>(<span class="pl-c1">room</span>) <span class="pl-k">end</span>.</pre></div>

<h2>
<a id="performance" class="anchor" href="#performance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Performance</h2>

<p>ab, httperf, wrk and siege are all used for measuring performance. 
The most valuable request hell is created by wrk and even though it 
is not achievable in real apps, it can demonstrate internal throughput 
of certain individual components. </p>

<p>The nearest to real life apps is siege which also performs a DNS lookup
for each request. The data below shows internal data throughput by wrk:</p>

<table>
<thead>
<tr>
<th>Framework</th>
<th>Enabled Components</th>
<th>Speed</th>
<th>Timeouts</th>
</tr>
</thead>
<tbody>
<tr>
<td>PHP5 FCGI</td>
<td>Simple script with two &lt;?php print "OK"; ?&gt;</td>
<td>5K</td>
<td>timeouts</td>
</tr>
<tr>
<td>ChicagoBoss</td>
<td>No sessions, No DSL, Simple DTL</td>
<td>500</td>
<td>no</td>
</tr>
<tr>
<td>Nitrogen</td>
<td>No sessions, No DSL, Simple DTL</td>
<td>1K</td>
<td>no</td>
</tr>
<tr>
<td>N2O</td>
<td>All enabled, sessions, Template, heavy DSL</td>
<td>7K</td>
<td>no</td>
</tr>
<tr>
<td>N2O</td>
<td>Sessions enabled, template with two variables, no DSL</td>
<td>10K</td>
<td>no</td>
</tr>
<tr>
<td>N2O</td>
<td>No sessions, No DSL, only template with two vars</td>
<td>15K</td>
<td>no</td>
</tr>
</tbody>
</table>

<h2>
<a id="kickstart-bootstrap" class="anchor" href="#kickstart-bootstrap" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kickstart Bootstrap</h2>

<p>To try N2O you  need to clone a N2O repo from Github and build it.
We use a very small and powerful tool called mad designed specially for our Web Stack.</p>

<pre><code>$ git clone git://github.com/synrc/n2o
$ cd n2o/samples
$ ./mad deps compile plan repl
</code></pre>

<p>Now you can try it out: <a href="http://localhost:8000">http://localhost:8000</a></p>

<p>LINUX NOTE: if you want to have online recompilation you should install <code>inotify-tools</code> first:</p>

<pre><code>$ sudo apt-get install inotify-tools
</code></pre>

<h2>
<a id="erlang-version" class="anchor" href="#erlang-version" aria-hidden="true"><span class="octicon octicon-link"></span></a>Erlang version</h2>

<p>We don't accept any reports of problems related to ESL or Ubuntu packaging.
We only support Erlang built from sources, official Windows package,
built with kerl or installed on Mac with homebrew. If you have any problems
with your favourite Erlang package for your OS, please report issues
to package maintainer.</p>

<h2>
<a id="posting-issues-on-github" class="anchor" href="#posting-issues-on-github" aria-hidden="true"><span class="octicon octicon-link"></span></a>Posting Issues on Github</h2>

<p>Thank you for using N2O (you've made a wise choice) and your contributions
to help make it better. Before posting an issue on Github, please contact
us via the options listed below in the support section. Doing so will
help us determine whether your issue is a suggested feature, refactor
of existing code, bug, etc, that needs to be posted to GitHub for the
contributing development community of N2O to incorporate. DO NOT post
issues to GitHub related to misuses of N2O, all such issues will be closed.</p>

<h2>
<a id="support" class="anchor" href="#support" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support</h2>

<ul>
<li><a href="https://gitter.im/synrc/n2o?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Gitter"></a></li>
<li>IRC Channel #n2o on FreeNode 24/7</li>
</ul>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>If you are new or you need to decide whether the N2O architecture
and philosophy is a fit for your project</p>

<ul>
<li>Official N2O Book <a href="http://synrc.com/apps/n2o/doc/book.pdf">PDF</a>
</li>
</ul>

<h2>
<a id="windows-users" class="anchor" href="#windows-users" aria-hidden="true"><span class="octicon octicon-link"></span></a>Windows Users</h2>

<p>For windows you should install <a href="http://msys2.github.io">http://msys2.github.io</a> and
appropriative packages to use Synrc Stack:</p>

<ul>
<li>pacman -S git</li>
</ul>

<h2>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span class="octicon octicon-link"></span></a>Credits</h2>

<ul>
<li>Maxim Sokhatsky — core, shen, windows</li>
<li>Dmitry Bushmelev — endpoints, yaws, cowboy</li>
<li>Andrii Zadorozhnii — elements, actions, handlers</li>
<li>Vladimir Kirillov — mac, bsd, xen, linux support</li>
<li>Andrey Martemyanov — binary protocols</li>
<li>Oleksandr Nikitin — security</li>
<li>Anton Logvinenko — doc</li>
<li>Roman Shestakov — advanced elements, ct</li>
<li>Jesse Gumm — nitrogen, help</li>
<li>Rusty Klophaus — original author</li>
</ul>

<p>OM A HUM</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">N2O maintained by <a href="https://github.com/synrc">synrc</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
